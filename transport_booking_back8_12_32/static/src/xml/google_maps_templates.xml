<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <!-- Google Maps Widget Template -->
    <t t-name="transport_booking.GoogleMapsWidget" owl="1">
        <div class="o_google_maps_widget" 
             style="width: 100%; min-height: 600px; height: 600px; position: relative;">
            
            <!-- Loading Indicator -->
            <div t-if="isCalculating" 
                 style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                        z-index: 2000; background: white; padding: 20px; border-radius: 10px;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.3);">
                <div style="text-align: center;">
                    <div class="fa fa-spinner fa-spin fa-3x text-primary"></div>
                    <div style="margin-top: 10px; font-size: 16px;">กำลังคำนวณเส้นทาง...</div>
                </div>
            </div>
            
            <!-- Recalculate Button - ซ่อนเมื่อสถานะเป็น 'done' หรือ 'cancelled' -->
            <button t-if="props.record.data.state !== 'done' and props.record.data.state !== 'cancelled'"
                    t-on-click="forceRecalculate" 
                    class="btn btn-primary"
                    style="position: absolute; top: 10px; right: 10px; z-index: 1000;">
                <i class="fa fa-refresh"></i> คำนวณเส้นทางใหม่
            </button>
            
            <!-- Map Container -->
            <div t-ref="googleMap" 
                 style="width: 100%; height: 100%; min-height: 600px;
                        border-radius: 15px; overflow: hidden; 
                        box-shadow: 0 4px 20px rgba(0,0,0,0.15);
                        background: #f0f0f0;">
            </div>
        </div>
    </t>

    <!-- Location Autocomplete Widget Template -->
    <t t-name="transport_booking.LocationAutocompleteWidget" owl="1">
        <div class="o_field_char o_field_location_autocomplete">
            <input 
                t-ref="locationInput"
                type="text"
                class="o_input"
                t-att-placeholder="props.placeholder"
                t-att-readonly="props.readonly ? 'readonly' : undefined"
                t-att-value="state.value"
                t-on-input="onInputChange"
                style="width: 100%; padding: 8px; 
                       border: 1px solid #ced4da; border-radius: 4px;
                       font-size: 14px;"
            />
        </div>
    </t>
</templates>
