<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ==================== ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏£‡∏ñ‡∏£‡πà‡∏ß‡∏° ==================== -->
    <record id="view_vehicle_partner_company_list" model="ir.ui.view">
        <field name="name">vehicle.partner.company.list</field>
        <field name="model">vehicle.partner.company</field>
        <field name="arch" type="xml">
            <list string="‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏£‡∏ñ‡∏£‡πà‡∏ß‡∏°">
                <field name="code"/>
                <field name="name"/>
                <field name="persona"/>
                <field name="contact_person"/>
                <field name="phone"/>
                <field name="email"/>
                <field name="vehicle_count"/>
                <field name="active" widget="boolean_toggle"/>
            </list>
        </field>
    </record>

    <record id="view_vehicle_partner_company_form" model="ir.ui.view">
        <field name="name">vehicle.partner.company.form</field>
        <field name="model">vehicle.partner.company</field>
        <field name="arch" type="xml">
            <form string="‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏£‡∏ñ‡∏£‡πà‡∏ß‡∏°">
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="action_view_vehicles" type="object" class="oe_stat_button" icon="fa-truck">
                            <field name="vehicle_count" widget="statinfo" string="‡∏£‡∏ñ"/>
                        </button>
                    </div>
                    <div class="oe_title">
                        <h1><field name="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó"/></h1>
                    </div>
                    <group>
                        <group>
                            <field name="code"/>
                            <field name="company_type" widget="radio"/>
                            <field name="persona" widget="radio"/>
                            <field name="contact_person"/>
                            <field name="phone" widget="phone"/>
                            <field name="email" widget="email"/>
                        </group>
                        <group>
                            <field name="street"/>
                            <field name="city"/>
                            <field name="state_id"/>
                            <field name="tax_id"/>
                            <field name="branch_id"/>
                            <field name="active" invisible="1"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏">
                            <field name="note"/>
                        </page>
                    </notebook>
                </sheet>
                <chatter>
                    <field name="message_follower_ids"/>
                    <field name="message_ids"/>
                </chatter>
            </form>
        </field>
    </record>

    <!-- ==================== ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏£‡∏ñ (Fleet Vehicle Extension) ==================== -->
    <record id="view_fleet_vehicle_list_inherit" model="ir.ui.view">
        <field name="name">fleet.vehicle.list.inherit</field>
        <field name="model">fleet.vehicle</field>
        <field name="inherit_id" ref="fleet.fleet_vehicle_view_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='driver_id']" position="after">
                <field name="vehicle_type_t" optional="hide"/>
                <field name="ownership" optional="hide"/>
                <field name="vehicle_status" optional="hide" decoration-success="vehicle_status=='available'" decoration-danger="vehicle_status=='maintenance'"/>
            </xpath>
        </field>
    </record>

    <record id="view_fleet_vehicle_form_inherit" model="ir.ui.view">
        <field name="name">fleet.vehicle.form.inherit</field>
        <field name="model">fleet.vehicle</field>
        <field name="inherit_id" ref="fleet.fleet_vehicle_view_form"/>
        <field name="arch" type="xml">
            <!-- ‡∏ã‡πà‡∏≠‡∏ô‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ -->
            <xpath expr="//field[@name='plan_to_change_car']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='future_driver_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            
            <xpath expr="//div[@name='button_box']" position="inside">
                <button name="action_view_documents" type="object" class="oe_stat_button" icon="fa-file-text-o">
                    <field name="document_count" widget="statinfo" string="‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£"/>
                </button>
                <button name="action_view_maintenance" type="object" class="oe_stat_button" icon="fa-wrench">
                    <field name="maintenance_count" widget="statinfo" string="‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°"/>
                </button>
            </xpath>
            <xpath expr="//field[@name='model_id']" position="after">
                <field name="ownership"/>
                <field name="partner_company_id" invisible="ownership == 'own'"/>
                <field name="vehicle_status"/>
                <field name="current_driver_id"/>
            </xpath>
            
            <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏´‡∏•‡∏±‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢ (next_assignation_date) -->
            <xpath expr="//field[@name='next_assignation_date']" position="after">
                <field name="has_gps" widget="boolean_toggle"/>
                <field name="affiliation" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏ú‡∏ô‡∏Å"/>
                <field name="branch_id" placeholder="‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤"/>
                <field name="has_fuel_card" widget="boolean_toggle"/>
                <field name="vehicle_rating" widget="priority" />
<!--                <field name="vehicle_rating_x" widget="priority"/>-->
            </xpath>
            <xpath expr="//field[@name='category_id']" position="after">
                <field name="vehicle_check_status"/>
            </xpath>
            <xpath expr="//notebook" position="inside">
                <page string="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏ñ">
                    <group>
                        <group string="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ">
                            <field name="vehicle_type_t" widget="selection"/>
                            <field name="payload_capacity"/>
                            <field name="registration_year"/>
                            <field name="engine_number"/>
                            <field name="chassis_number"/>
                        </group>
                        <group string="‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£">
                            <field name="tax_expiry_date"/>
                            <field name="insurance_expiry_date"/>
                            <field name="compulsory_insurance_expiry"/>
                        </group>
                    </group>
                    <group>
                        <group string="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á">
                            <field name="engine_oil_type" placeholder="‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á"/>
                            <field name="engine_oil_capacity" placeholder="0.00"/>
                        </group>
                        <group>
                        </group>
                    </group>
                </page>
                <page string="‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£">
                    <field name="document_ids">
                        <list>
                            <field name="name"/>
                            <field name="document_type"/>
                            <field name="document_number"/>
                            <field name="expiry_date"/>
                            <field name="status" decoration-success="status=='valid'" decoration-warning="status=='expiring_soon'" decoration-danger="status=='expired'"/>
                        </list>
                    </field>
                </page>
                <page string="‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á">
                    <separator string="‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°"/>
                    <field name="maintenance_request_ids">
                        <list>
                            <field name="name"/>
                            <field name="request_date"/>
                            <field name="problem_category"/>
                            <field name="priority" widget="priority"/>
                            <field name="state"/>
                        </list>
                    </field>
                    <separator string="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°"/>
                    <field name="maintenance_history_ids">
                        <list>
                            <field name="name"/>
                            <field name="maintenance_date"/>
                            <field name="problem_category"/>
                            <field name="cost" sum="‡∏£‡∏ß‡∏°"/>
                        </list>
                    </field>
                </page>
            </xpath>
        </field>
    </record>

    <!-- ==================== ‡∏ú‡∏π‡πâ‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà ==================== -->
    <record id="view_vehicle_driver_list" model="ir.ui.view">
        <field name="name">vehicle.driver.list</field>
        <field name="model">vehicle.driver</field>
        <field name="arch" type="xml">
            <list string="‡∏ú‡∏π‡πâ‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà">
                <field name="code"/>
                <field name="name"/>
                <field name="pin" password="True" optional="hide"/>
                <field name="phone"/>
                <field name="license_number"/>
                <field name="license_type"/>
                <field name="license_status" decoration-success="license_status=='valid'" decoration-warning="license_status=='expiring_soon'" decoration-danger="license_status=='expired'"/>
                <field name="employment_status"/>
                <field name="branch_id"/>
                <field name="active" widget="boolean_toggle"/>
            </list>
        </field>
    </record>

    <record id="view_vehicle_driver_form" model="ir.ui.view">
        <field name="name">vehicle.driver.form</field>
        <field name="model">vehicle.driver</field>
        <field name="arch" type="xml">
            <form string="‡∏ú‡∏π‡πâ‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà">
                <sheet>
                    <field name="image_1920" widget="image" class="oe_avatar" options="{'preview_image': 'image_128'}"/>
                    <div class="oe_title">
                        <h1><field name="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•"/></h1>
                        <h3><field name="code" readonly="1"/></h3>
                    </div>
                    <group>
                        <group string="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô">
                            <field name="pin" password="True" placeholder="‡∏Å‡∏£‡∏≠‡∏Å PIN 6 ‡∏´‡∏•‡∏±‡∏Å"/>
                            <field name="citizen_id"/>
                            <field name="birth_date"/>
                            <field name="phone" widget="phone"/>
                            <field name="email" widget="email"/>
                            <field name="employment_status"/>
                            <field name="branch_id"/>
                            <field name="said_date" placeholder="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢"/>
                            <field name="partner_company_id" invisible="employment_status != 'partner'"/>
                        </group>
                        <group string="‡πÉ‡∏ö‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà">
                            <field name="license_number"/>
                            <field name="license_type"/>
                            <field name="license_issue_date"/>
                            <field name="license_expiry_date"/>
                            <field name="license_status"/>
                            <field name="vehicle_id"/>
                            <field name="active" invisible="1"/>
                        </group>
                    </group>
                    <notebook>
<!--                        <page string="‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ">-->
<!--                            <field name="trip_ids">-->
<!--                                <list>-->
<!--                                    <field name="start_date"/>-->
<!--                                    <field name="vehicle_id"/>-->
<!--                                    <field name="origin"/>-->
<!--                                    <field name="destination"/>-->
<!--                                    <field name="distance"/>-->
<!--                                    <field name="status"/>-->
<!--                                </list>-->
<!--                            </field>-->
<!--                        </page>-->
                        <page string="‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏">
                            <field name="accident_ids">
                                <list>
                                    <field name="accident_date"/>
                                    <field name="vehicle_id"/>
                                    <field name="location"/>
                                    <field name="severity" decoration-success="severity=='minor'" decoration-warning="severity=='moderate'" decoration-danger="severity=='major'"/>
                                    <field name="damage_cost"/>
                                </list>
                            </field>
                        </page>
                        <page string="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏">
                            <field name="note"/>
                        </page>
                    </notebook>
                </sheet>
                <chatter>
                    <field name="message_follower_ids"/>
                    <field name="message_ids"/>
                </chatter>
            </form>
        </field>
    </record>

    <!-- ==================== ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏° ==================== -->
    <record id="view_vehicle_maintenance_request_list" model="ir.ui.view">
        <field name="name">vehicle.maintenance.request.list</field>
        <field name="model">vehicle.maintenance.request</field>
        <field name="arch" type="xml">
            <list string="‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°" decoration-info="state=='draft'" decoration-warning="state in ['pending','in_progress']" decoration-success="state=='done'">
                <field name="name"/>
                <field name="request_date"/>
                <field name="vehicle_id"/>
                <field name="license_plate"/>
                <field name="problem_category"/>
                <field name="priority" widget="priority"/>
                <field name="assigned_to_id"/>
                <field name="actual_cost" sum="Total"/>
                <field name="state" widget="badge"/>
            </list>
        </field>
    </record>

    <record id="view_vehicle_maintenance_request_form" model="ir.ui.view">
        <field name="name">vehicle.maintenance.request.form</field>
        <field name="model">vehicle.maintenance.request</field>
        <field name="arch" type="xml">
            <form string="‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°">
                <header>
                    <button name="action_confirm" string="‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°" 
                        type="object" class="btn-primary" 
                        invisible="state != 'draft' or approval_state == 'pending'"/>
                    <button name="action_view_approvals" string="üìã ‡∏î‡∏π‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥" 
                        type="object" class="btn-info"
                        invisible="approval_count == 0"/>
                    <button name="action_start" string="‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ã‡πà‡∏≠‡∏°" 
                        type="object" class="btn-primary" 
                        invisible="state != 'pending' or approval_state != 'approved'"/>
                    <button name="action_done" string="‡∏ã‡πà‡∏≠‡∏°‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô" 
                        type="object" class="btn-success" 
                        invisible="state != 'in_progress'"/>
                    <button name="action_cancel" string="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å" 
                        type="object" 
                        invisible="state in ['done','cancelled']"/>
                    <field name="state" widget="statusbar" 
                        statusbar_visible="draft,pending,in_progress,done"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="action_view_approvals" type="object" 
                            class="oe_stat_button" icon="fa-check-circle"
                            invisible="approval_count == 0">
                            <field name="approval_count" widget="statinfo" string="‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥"/>
                        </button>
                    </div>
                    
                    <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ -->
                    <div class="alert alert-warning" role="alert" 
                        invisible="approval_state != 'pending'">
                        <strong>‚è≥ ‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</strong>
                        <p>‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</p>
                    </div>
                    <div class="alert alert-success" role="alert" 
                        invisible="approval_state != 'approved'">
                        <strong>‚úÖ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß</strong>
                        <p>‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ</p>
                    </div>
                    <div class="alert alert-danger" role="alert" 
                        invisible="approval_state != 'rejected'">
                        <strong>‚ùå ‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</strong>
                        <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ ‡πÅ‡∏•‡πâ‡∏ß‡∏™‡πà‡∏á‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡∏°‡πà</p>
                    </div>
                    
                    <div class="oe_title">
                        <h1><field name="name" readonly="1"/></h1>
                    </div>
                    <group>
                        <group>
                            <field name="vehicle_id" readonly="approval_state == 'approved'"/>
                            <field name="license_plate" readonly="1"/>
                            <field name="requester_id" readonly="approval_state == 'approved'"/>
                            <field name="request_date" readonly="approval_state == 'approved'"/>
                        </group>
                        <group>
                            <field name="problem_category" readonly="approval_state == 'approved'"/>
                            <field name="priority" widget="priority" readonly="approval_state == 'approved'"/>
                            <field name="assigned_to_id" readonly="approval_state == 'approved'"/>
                            <field name="approval_state" 
                                widget="badge"
                                decoration-warning="approval_state=='waiting'"
                                decoration-success="approval_state=='approved'"
                                decoration-danger="approval_state=='rejected'"/>
                        </group>
                    </group>
                    <group>
                        <field name="problem_description" 
                            placeholder="‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÇ‡∏î‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î..." 
                            readonly="approval_state == 'approved'"/>
                    </group>
                    <group>
                        <group>
                            <field name="estimated_cost" readonly="approval_state == 'approved'"/>
                            <!-- ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß -->
                            <field name="actual_cost"/>
                        </group>
                        <group>
                            <field name="start_date" readonly="approval_state == 'approved'"/>
                            <!-- ‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏°‡πÄ‡∏™‡∏£‡πá‡∏à - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß -->
                            <field name="completion_date"/>
                            <field name="is_used_in_history" invisible="1"/>
                            <field name="history_id" readonly="1" invisible="not is_used_in_history"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥" invisible="approval_count == 0">
                            <field name="approval_ids" nolabel="1">
                                <list>
                                    <field name="sequence" widget="handle"/>
                                    <field name="approver_id"/>
                                    <field name="state" 
                                        decoration-warning="state=='pending'"
                                        decoration-success="state=='approved'"
                                        decoration-danger="state=='rejected'"/>
                                    <field name="approval_date"/>
                                    <button name="action_approve" string="‚úÖ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥" 
                                        type="object" 
                                        invisible="state != 'pending'"/>
                                    <button name="action_reject" string="‚ùå ‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç" 
                                        type="object" 
                                        invisible="state != 'pending'"/>
                                </list>
                            </field>
                        </page>
                        <page string="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏">
                            <field name="note"/>
                        </page>
                    </notebook>
                </sheet>
                <chatter>
                    <field name="message_follower_ids"/>
                    <field name="message_ids"/>
                </chatter>
            </form>
        </field>
    </record>

    <!-- ==================== ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏° ==================== -->
    <record id="view_vehicle_maintenance_history_list" model="ir.ui.view">
        <field name="name">vehicle.maintenance.history.list</field>
        <field name="model">vehicle.maintenance.history</field>
        <field name="arch" type="xml">
            <list string="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°">
                <field name="name"/>
                <field name="maintenance_date"/>
                <field name="vehicle_id"/>
                <field name="license_plate"/>
                <field name="problem_category"/>
                <field name="service_provider"/>
                <field name="cost" sum="Total"/>
                <field name="completed_date"/>
                <field name="state" widget="badge" 
                    decoration-info="state=='draft'"
                    decoration-success="state=='confirmed'"
                    decoration-muted="state=='cancelled'"/>
            </list>
        </field>
    </record>

    <record id="view_vehicle_maintenance_history_form" model="ir.ui.view">
        <field name="name">vehicle.maintenance.history.form</field>
        <field name="model">vehicle.maintenance.history</field>
        <field name="arch" type="xml">
            <form string="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°">
                <header>
                    <button name="action_confirm_usage" 
                        string="‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô" 
                        type="object" 
                        class="btn-primary"
                        invisible="state != 'draft'"
                        confirm="‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ô‡∏µ‡πâ? ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ"/>
                    <button name="action_cancel" 
                        string="‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å" 
                        type="object" 
                        class="btn-warning"
                        invisible="state != 'confirmed'"
                        confirm="‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ô‡∏µ‡πâ? ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å"/>
                    <button name="action_set_to_draft" 
                        string="üîÑ ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏ö‡∏ö‡∏£‡πà‡∏≤‡∏á" 
                        type="object"
                        invisible="state == 'draft'"/>
                    <field name="state" widget="statusbar" 
                        statusbar_visible="draft,confirmed"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1><field name="name" readonly="1"/></h1>
                    </div>
                    
                    <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô -->
                    <div class="alert alert-success" role="alert" 
                        invisible="state != 'confirmed'">
                        <strong>‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß</strong>
                        <p>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Å</p>
                    </div>
                    
                    <div class="alert alert-warning" role="alert" 
                        invisible="state != 'cancelled'">
                        <strong>‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß</strong>
                        <p>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß</p>
                    </div>
                    
                    <group>
                        <group>
                            <field name="maintenance_request_id"
                                domain="[('approval_state', '=', 'approved'), ('is_used_in_history', '=', False)]"
                                context="{'default_approval_state': 'approved'}"
                                readonly="state != 'draft'"/>
                            <field name="vehicle_id" readonly="state == 'confirmed'"/>
                            <field name="license_plate" readonly="1"/>
                            <field name="problem_category" readonly="state == 'confirmed'"/>
                            <field name="maintenance_date" readonly="state == 'confirmed'"/>
                            <field name="completed_date" readonly="state == 'confirmed'"/>
                        </group>
                        <group>
                            <field name="service_provider" readonly="state == 'confirmed'"/>
                            <field name="technician_id" 
                                invisible="service_provider != 'internal'" 
                                readonly="state == 'confirmed'"/>
                            <field name="service_center" 
                                invisible="service_provider != 'external'" 
                                readonly="state == 'confirmed'"/>
                            <field name="cost" readonly="state == 'confirmed'"/>

                        </group>
                    </group>
                    <group>
                        <field name="description" 
                            placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á..." 
                            readonly="state == 'confirmed'"/>
                    </group>
                    <notebook>
                        <page string="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏">
                            <field name="note"/>
                        </page>
                    </notebook>
                </sheet>
                <chatter>
                    <field name="message_follower_ids"/>
                    <field name="message_ids"/>
                </chatter>
            </form>
        </field>
    </record>

    <!-- ========== ACTIONS (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô MENUS) ========== -->
    <record id="action_vehicle_partner_company" model="ir.actions.act_window">
        <field name="name">‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏£‡∏ñ‡∏£‡πà‡∏ß‡∏°</field>
        <field name="res_model">vehicle.partner.company</field>
        <field name="view_mode">list,form</field>
    </record>


    <record id="action_vehicle_driver" model="ir.actions.act_window">
        <field name="name">‡∏ú‡∏π‡πâ‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà</field>
        <field name="res_model">vehicle.driver</field>
        <field name="view_mode">list,form</field>
    </record>

    <record id="action_vehicle_maintenance_request" model="ir.actions.act_window">
        <field name="name">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°</field>
        <field name="res_model">vehicle.maintenance.request</field>
        <field name="view_mode">list,form</field>
    </record>

    <record id="action_vehicle_maintenance_history" model="ir.actions.act_window">
        <field name="name">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°</field>
        <field name="res_model">vehicle.maintenance.history</field>
        <field name="view_mode">list,form</field>
    </record>

    <!-- ==================== MENUS ==================== -->
    <!-- ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏¢‡∏≤‡∏ô‡∏û‡∏≤‡∏´‡∏ô‡∏∞ - ‡∏≠‡∏¢‡∏π‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡πÄ‡∏°‡∏ô‡∏π Fleet -->


    <!-- ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏£‡∏ñ‡∏£‡πà‡∏ß‡∏° -->
    <menuitem id="menu_vehicle_partner_company"
              name="‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏£‡∏ñ‡∏£‡πà‡∏ß‡∏°"
              parent="fleet.menu_root"
              action="action_vehicle_partner_company"
              sequence="15"/>

    <!-- ‡∏ú‡∏π‡πâ‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà -->
    <menuitem id="menu_vehicle_driver"
              name="‡∏ú‡∏π‡πâ‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà"
              parent="fleet.menu_root"
              action="action_vehicle_driver"
              sequence="20"/>

    <!-- ‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á (‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å) -->
    <menuitem id="menu_vehicle_maintenance"
              name="‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á"
              parent="fleet.menu_root"
              sequence="30"/>

    <!-- ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏° (sub-menu) -->
    <menuitem id="menu_vehicle_maintenance_request"
              name="‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°"
              parent="menu_vehicle_maintenance"
              action="action_vehicle_maintenance_request"
              sequence="10"/>

    <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏° (sub-menu) -->
    <menuitem id="menu_vehicle_maintenance_history"
              name="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°"
              parent="menu_vehicle_maintenance"
              action="action_vehicle_maintenance_history"
              sequence="20"/>

    <!-- ======================================= ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô ======================================= -->
    
    <!-- ‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô -->
    <record id="view_vehicle_maintenance_notification_tree" model="ir.ui.view">
        <field name="name">vehicle.maintenance.notification.tree</field>
        <field name="model">vehicle.maintenance.notification</field>
        <field name="arch" type="xml">
            <list string="üì± ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô" decoration-warning="not notification_enabled">
                <field name="problem_category" widget="badge" decoration-info="problem_category=='engine'" decoration-warning="problem_category=='transmission'" decoration-danger="problem_category=='brake'"/>
                <field name="license_plate"/>
                <field name="notification_enabled" widget="boolean_toggle"/>
                <field name="notification_interval"/>
                <field name="notification_last_sent"/>
                <field name="notification_count" sum="‡∏£‡∏ß‡∏°"/>
            </list>
        </field>
    </record>

    <!-- List View ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö notification.history (Embedded) -->
    <record id="view_notification_history_list_embedded" model="ir.ui.view">
        <field name="name">notification.history.list.embedded</field>
        <field name="model">notification.history</field>
        <field name="arch" type="xml">
            <list string="‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô">
                <field name="create_date" string="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á"/>
                <field name="title"/>
                <field name="status"/>
                <field name="is_read"/>
                <field name="read_date"/>
            </list>
        </field>
    </record>

    <!-- Form View ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Microsoft Teams Notification -->
    <record id="view_vehicle_maintenance_notification_form" model="ir.ui.view">
        <field name="name">vehicle.maintenance.notification.form</field>
        <field name="model">vehicle.maintenance.notification</field>
        <field name="arch" type="xml">
            <form string="üì± ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô">
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="action_send_notification_if_interval_complete" type="object" class="oe_highlight" string="üöÄ ‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô)"/>
                    </div>
                    <h2>üì± ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</h2>
                    
                    <group>
                        <group string="üìå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°">
                            <field name="problem_category"/>
                            <field name="vehicle_id"/>
                            <field name="license_plate" readonly="1"/>
                        </group>
                        <group string="üë• ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô">
                            <field name="recipient_ids" widget="many2many_tags"/>
                        </group>
                    </group>

                    <separator string="üìÖ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô"/>
                    <group>
                        <group>
                            <field name="notification_enabled" widget="boolean_toggle" string="‚úÖ ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô"/>
                            <field name="notification_start_date"/>
                            <field name="notification_interval"/>
                        </group>
                        <group>
                            <field name="notification_end_date" readonly="1"/>
                        </group>
                    </group>

                    <separator string="üìä ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á"/>
                    <group>
                        <group>
                            <field name="notification_last_sent" readonly="1"/>
                            <field name="notification_count" readonly="1"/>
                        </group>
                    </group>

                    <separator string="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏"/>
                    <field name="note"/>

                    <separator string="üìù ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô"/>
                    <field name="notification_history_ids" readonly="1" widget="one2many_list" view_mode="list">
                        <list string="‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô">
                            <field name="create_date" string="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á"/>
                            <field name="title"/>
                            <field name="status"/>
                            <field name="is_read"/>
                            <field name="read_date"/>
                        </list>
                    </field>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Action ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô -->
    <record id="action_vehicle_maintenance_notification" model="ir.actions.act_window">
        <field name="name">üì± ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</field>
        <field name="res_model">vehicle.maintenance.notification</field>
        <field name="view_mode">list,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            </p>
        </field>
    </record>

    <!-- ‡πÄ‡∏°‡∏ô‡∏π‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô - ‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô -->
    <menuitem id="menu_vehicle_maintenance_notification"
              name="üì± ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô"
              parent="menu_vehicle_maintenance"
              action="action_notification_history"
              sequence="30"/>

    <!-- ======================================= ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô ======================================= -->

    <!-- ‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô -->
    <record id="view_notification_history_tree" model="ir.ui.view">
        <field name="name">notification.history.tree</field>
        <field name="model">notification.history</field>
        <field name="arch" type="xml">
            <list string="üìù ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô" decoration-warning="status=='sent'" decoration-success="status=='read'">
                <field name="problem_category" widget="badge" decoration-info="problem_category=='engine'" decoration-warning="problem_category=='transmission'" decoration-danger="problem_category=='brake'"/>
                <field name="vehicle_id"/>
                <field name="license_plate"/>
                <field name="create_date" string="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á"/>
                <field name="title"/>
                <field name="status" widget="badge"/>
                <field name="is_read" widget="boolean"/>
                <field name="read_date"/>
            </list>
        </field>
    </record>

    <!-- ‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô -->
    <record id="view_notification_history_form" model="ir.ui.view">
        <field name="name">notification.history.form</field>
        <field name="model">notification.history</field>
        <field name="arch" type="xml">
            <form string="üìù ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô">
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="mark_as_read" type="object" class="oe_highlight" string="‚úì ‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡πà‡∏≤‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß" invisible="is_read"/>
                    </div>
                    
                    <h2>üìù ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h2>
                    
                    <group>
                        <group string="üìå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô">
                            <field name="problem_category" widget="badge"/>
                            <field name="vehicle_id"/>
                            <field name="license_plate"/>
                        </group>
                        <group string="üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î">
                            <field name="title" readonly="1"/>
                            <field name="create_date" readonly="1" string="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á"/>
                            <field name="status" widget="badge" readonly="1"/>
                        </group>
                    </group>
                    
                    <group>
                        <group string="üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô">
                            <field name="is_read" readonly="1"/>
                            <field name="read_date" readonly="1"/>
                            <field name="notification_type" readonly="1"/>
                        </group>
                    </group>

                    <separator string="‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô"/>
                    <field name="recipient_ids" readonly="1" widget="many2many_tags"/>
                    
                    <separator string="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏"/>
                    <field name="note"/>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Action ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô -->
    <record id="action_notification_history" model="ir.actions.act_window">
        <field name="name">üìù ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</field>
        <field name="res_model">notification.history</field>
        <field name="view_mode">list,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            </p>
        </field>
    </record>

    <!-- ‡πÄ‡∏°‡∏ô‡∏π‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (Submenu) -->
    <menuitem id="menu_notification_history"
              name="üìù ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô"
              parent="menu_vehicle_maintenance_notification"
              action="action_notification_history"
              sequence="10"/>

    <!-- ‡πÄ‡∏°‡∏ô‡∏π‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (Submenu) -->
    <menuitem id="menu_vehicle_maintenance_notification_settings"
              name="‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô"
              parent="menu_vehicle_maintenance_notification"
              action="action_vehicle_maintenance_notification"
              sequence="20"/>

    <!-- ======================================= Server Actions ======================================= -->
    
    <!-- Server Action: ‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á Teams ===== -->
    <record id="action_send_teams_notification" model="ir.actions.server">
        <field name="name">üì§ ‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô Microsoft Teams</field>
        <field name="model_id" ref="vehicle_registration.model_vehicle_maintenance_history"/>
        <field name="binding_model_id" ref="vehicle_registration.model_vehicle_maintenance_history"/>
        <field name="state">code</field>
        <field name="code">
for record in records:
    notification = record.env['vehicle.maintenance.notification'].search([('maintenance_id', '=', record.id)], limit=1)
    if notification:
        notification.action_send_notification()
    else:
        record.env['vehicle.maintenance.notification'].create({
            'maintenance_id': record.id,
            'teams_webhook_url': record.env['ir.config_parameter'].sudo().get_param('vehicle.teams_webhook_url', '')
        }).action_send_notification()
        </field>
    </record>

    <!-- Server Action: ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏° ===== -->
    <record id="action_enable_teams_notification" model="ir.actions.server">
        <field name="name">‚úÖ ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô Microsoft Teams</field>
        <field name="model_id" ref="vehicle_registration.model_vehicle_maintenance_history"/>
        <field name="binding_model_id" ref="vehicle_registration.model_vehicle_maintenance_history"/>
        <field name="state">code</field>
        <field name="code">
for record in records:
    notification = record.env['vehicle.maintenance.notification'].search([('maintenance_id', '=', record.id)], limit=1)
    if not notification:
        record.env['vehicle.maintenance.notification'].create({
            'maintenance_id': record.id,
            'notification_enabled': True,
            'teams_webhook_url': record.env['ir.config_parameter'].sudo().get_param('vehicle.teams_webhook_url', '')
        })
    else:
        notification.write({'notification_enabled': True})
        </field>
    </record>

    <!-- Server Action: ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô ===== -->
    <record id="action_disable_teams_notification" model="ir.actions.server">
        <field name="name">‚ùå ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô Microsoft Teams</field>
        <field name="model_id" ref="vehicle_registration.model_vehicle_maintenance_history"/>
        <field name="binding_model_id" ref="vehicle_registration.model_vehicle_maintenance_history"/>
        <field name="state">code</field>
        <field name="code">
for record in records:
    notification = record.env['vehicle.maintenance.notification'].search([('maintenance_id', '=', record.id)], limit=1)
    if notification:
        notification.write({'notification_enabled': False})
        </field>
    </record>

    <!-- Server Action: ‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô) ===== -->
    <record id="action_send_notification_if_interval_complete" model="ir.actions.server">
        <field name="name">üöÄ ‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô)</field>
        <field name="model_id" ref="vehicle_registration.model_vehicle_maintenance_notification"/>
        <field name="binding_model_id" ref="vehicle_registration.model_vehicle_maintenance_notification"/>
        <field name="state">code</field>
        <field name="code">
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö records ‡πÄ‡∏õ‡πá‡∏ô None ‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏á (‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ô‡∏à‡∏≤‡∏Å ir.cron)
if not records:
    # ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ó‡∏∏‡∏Å record ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
    records = env['vehicle.maintenance.notification'].search([('notification_enabled', '=', True)])

# ‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
for record in records:
    try:
        record.action_send_notification_if_interval_complete()
    except Exception as e:
        # ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å error ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏´‡∏¢‡∏∏‡∏î loop
        _logger.warning(f"‚ö†Ô∏è ‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô {record.id} ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: {str(e)}")
        </field>
    </record>
</odoo>